{%extends 'campusbuy2_0/base.html' %}
{% load static %}

{#{% load crispy_forms_tags %}#}

{% block content %}


    <!-- Start Login Register Area -->
            <div class="htc__login__register bg__white ptb--200"
                style="background: rgba(0, 0, 0, 0) url({% static 'images/bg/5.jpg' %}) no-repeat scroll center center / cover ;">
                <div class="container">
                    <div class="row">
                        <div class="col-md-6 ml-auto mr-auto">
                            <ul class="login__register__menu nav justify-contend-center" role="tablist">
                                <li role="presentation" class="login active"><a class="active" href="#login" role="tab"
                                        data-toggle="tab">Login</a></li>
                                <li role="presentation" class="register"><a href="#register" role="tab"
                                        data-toggle="tab">Register</a></li>
                            </ul>
                        </div>
                    </div>
                    <!-- Start Login Register Content -->
                    <div class="row tab-content">
                        <div class="col-md-6  ml-auto mr-auto">
                            <div class="htc__login__register__wrap">
                                <!-- Start Login  section -->
                                <div id="login" role="tabpanel" class="single__tabs__panel tab-pane active">
                                <p class="text-center">Login to access your merchant account.</p>
                                    <form class="login" action="#" method="POST" enctype="multipart/form-data">
                                        {% csrf_token %}
                                        <p style="color:red;">{{ error }}</p>
                                        <div class="form--group">
                                                <label style="font-weight: bold;" class="form--label" for="{{ login_form.username.id_for_label }}">Username or Email</label>
                                                {{ login_form.username }}
                                            </div>
                                            <div class="form--group">
                                                <label style="font-weight: bold;" class="form--label" for="{{ login_form.password.id_for_label }}">Password</label>
                                                {{ login_form.password }}
                                                <span toggle="#login-password" data-toggle="login-password"
                                                      class="zmdi zmdi-eye field--icon toggle--password"></span>
                                            </div>

                                        <div class="htc__login__btn mt--30">
                                            <input type="submit"  value="Login">
                                        </div>

                                    </form>
                                    <div class="tabs__checkbox">
                                        <input type="checkbox">
                                        <span> Remember me</span>
                                        <span class="forget"><a href={% url 'password_reset' %}>Forget Password?</a></span>
                                    </div>

                                </div>
                                <!-- End Login section -->

                                <!-- Start registration section -->
                                <div id="register" role="tabpanel" class="single__tabs__panel tab-pane">
                                <p class="text-center">You need to create an account to start selling on CampusBuy.</p>
                                    <form class="login" action="#" method="POST" enctype="multipart/form-data">
                                        {% csrf_token %}
                                        <div class="form--group">
                                            {{ registration_form.first_name.errors }}

                                                <label for="{{ registration_form.first_name.id_for_label }}" class="form--label">First Name</label>
                                                {{registration_form.first_name}}
                                            </div>
                                        <br>
                                            <div class="form--group">
                                                {{ registration_form.last_name.errors }}
                                                <label for="{{registration_form.last_name.id_for_label}}" class="form--label">Last Name</label>
                                                {{registration_form.last_name}}
                                            </div>
                                        <br>
                                            <div class="form--group">

                                                    <label  class="form--label" for="{{ registration_form.username.id_for_label }}">Username</label>
                                                    {{ registration_form.username }}
                                                    <span class="zmdi zmdi-close-circle field--icon  mr-auto ml-auto" id="username_incorrect" style="color:red;"></span>
                                                    <span class="zmdi zmdi-check-circle field--icon mr-auto ml-auto" id="username_correct" style="color:green;"></span>
                                            </div>
                                            <p class="mr-auto ml-auto" id="username_incorrect-text" style="color:red;">This username is already taken</p>
                                        <br>

                                            <div class="form--group">
                                                {{ registration_form.email.errors }}
                                                <label  class="form--label" for="{{ registration_form.email.id_for_label }}">Email</label>
                                               {{ registration_form.email }}
                                            <span class="zmdi zmdi-close-circle field--icon  mr-auto ml-auto" id="email_incorrect" style="color:red;"></span>
                                                    <span class="zmdi zmdi-check-circle field--icon mr-auto ml-auto" id="email_correct" style="color:green;"></span>
                                            </div>
                                            <p class="mr-auto ml-auto" id="email_incorrect-text" style="color:red;">A user with this email already exists</p>

                                        <br>
                                              <div class="form--group">
                                                  {{ registration_form.business_name.errors }}
                                                <label class="form--label" for="{{ registration_form.business_name.id_for_label }}">Business Name</label>
                                                {{ registration_form.business_name }}
                                            <span class="zmdi zmdi-close-circle field--icon  mr-auto ml-auto" id="business_name_incorrect" style="color:red;"></span>
                                                    <span class="zmdi zmdi-check-circle field--icon mr-auto ml-auto" id="business_name_correct" style="color:green;"></span>
                                            </div>
                                            <p class="mr-auto ml-auto" id="business_name_incorrect-text" style="color:red;">This business name is already taken</p>

                                        <br>
                                            <div class="form--group">
                                                {{ registration_form.address.errors }}
                                                <label  class="form--label" for="{{ registration_form.address.id_for_label }}">Address</label>
                                                {{ registration_form.address }}
                                            </div>
                                        <br>
                                            <div class="form--group">
                                                {{ registration_form.business_description.errors }}
                                                <label  class="form--label"for="{{ registration_form.business_description.id_for_label }}">Business Description</label>
                                               {{ registration_form.business_description }}
                                            </div>
                                        <br>
                                            <div class="form--group">
                                                {{ registration_form.phone_number.errors }}
                                                <label for="{{ registration_form.phone_number.id_for_label }}" class="form--label">Phone Number</label>
                                                {{ registration_form.phone_number }}
                                            </div>
                                        <br>
                                            <div class="form--group">
                                                {{ registration_form.whatsapp_number.errors }}
                                                <label for="{{ registration_form.whatsapp_number.id_for_label }}"class="form--label">Whatsapp Number</label>
                                               {{ registration_form.whatsapp_number }}
                                            </div>
                                        <br>

                                        <div class="form--group">
                                            {{ registration_form.school.errors }}
                                                <label for="{{ registration_form.school.id_for_label }}" class="form--label">Pick the School you operate in</label>
                                               {{ registration_form.school }}
                                        </div>
                                        <br>

                                         <div class="form--group">
                                             {{ registration_form.password1.errors }}
                                                <label for="{{ registration_form.password1.id_for_label }}" class="form--label">Password</label>
                                               {{ registration_form.password1}}
                                                <span toggle="#{{registration_form.password1.id_for_label}}" data-toggle="{{ registration_form.password1.id_for_label }}"
                                                    class="zmdi zmdi-eye field--icon toggle--password"></span>

                                              <span class="zmdi zmdi-close-circle field--icon  mr-auto ml-auto" id="password1_incorrect" style="color:red;position: absolute;right: -17px;"></span>
                                                    <span class="zmdi zmdi-check-circle field--icon mr-auto ml-auto" id="password1_correct" style="color: green;position: absolute;right: -17px;"></span>
                                            </div>
                                            <p class="mr-auto ml-auto" id="password1_incorrect-text" style="color:red; font-size:10px;">This password is not strong enough</p>



                                        <br>

                                        <div class="form--group">

                                                <label for="{{ registration_form.password2.id_for_label }}" class="form--label">Type Password Again</label>
                                           {{ registration_form.password2}}
                                                <span toggle="#{{registration_form.password2.id_for_label}}" data-toggle="{{ registration_form.password2.id_for_label }}" class="zmdi zmdi-eye field--icon toggle--password"></span>
                                                <span class="zmdi zmdi-close-circle field--icon" id="mismatch" style="color:red;margin-right:25px;"></span>
                                                <span class="zmdi zmdi-check-circle field--icon" id="match" style="color:green;margin-right:25px;"></span>
                                            </div>
                                        <br>

                                        <div class="htc__login__btn mt--30">
                                            <input type="submit"  value="Register">
                                        </div>

                                    </form>
                                    <div class="tabs__checkbox">
                                        <input type="checkbox">
                                        <span> Remember me</span>
                                    </div>
                                </div>
                                <!-- End Register Content -->
                            </div>
                        </div>
                    </div>
                    <!-- End Login Register Content -->
                </div>
            </div>
            <!-- End Login Register Area -->
{#        <div class="left">#}
{#            <h1>Sign Up</h1>#}
{#        </div>#}
{##}
{##}
{#        <form action="#" method="POST" enctype="multipart/form-data">#}
{#        {% csrf_token %}#}
{##}
{#        <p style="color:red;">{{ error }}</p>#}
{##}
{#        {{ form.as_p }}#}
{##}
{##}
{#        <input type="submit"  value="Submit">#}
{##}
{#        </form>#}
{##}

{% endblock %}


{%block javascript%}
<script>
    $('#username_incorrect-text').hide();
    $('#username_correct').hide();
    $('#username_incorrect').hide();
    $("#username").change(function(){
        var username = $(this).val();

        $.ajax({
            url: '{% url "validate_username" %}',
            data:{
                'username':username
                },
                dataType:'json',
                success: function (data) {
                if (data.username_exists) {
                //alert("A user with this username already exists.");

                $('#username_correct').hide();
                $('#username_incorrect').show();
                $('#username_incorrect-text').show();

                }else{

                $('#username_incorrect-text').hide();
                $('#username_incorrect').hide();
                $('#username_correct').show();
                }
            }
        });

    });

    $('#email_incorrect-text').hide();
    $('#email_correct').hide();
    $('#email_incorrect').hide();
    $("#email").change(function(){
        var email = $(this).val();

        $.ajax({
            url: '{% url "validate_email" %}',
            data:{
                'email':email
                },
                dataType:'json',
                success: function (data) {
                if (data.email_exists) {

                $('#email_correct').hide();
                $('#email_incorrect').show();
                $('#email_incorrect-text').show();

                }else{

                $('#email_incorrect-text').hide();
                $('#email_incorrect').hide();
                $('#email_correct').show();
                }
            }
        });

    });


     $('#business_name_incorrect-text').hide();
    $('#business_name_correct').hide();
    $('#business_name_incorrect').hide();
    $("#business_name").change(function(){
        var business_name = $(this).val();

        $.ajax({
            url: '{% url "validate_business_name" %}',
            data:{
                'business_name':business_name
                },
                dataType:'json',
                success: function (data) {
                if (data.business_name_exists) {

                $('#business_name_correct').hide();
                $('#business_name_incorrect').show();
                $('#business_name_incorrect-text').show();

                }else{

                $('#business_name_incorrect-text').hide();
                $('#business_name_incorrect').hide();
                $('#business_name_correct').show();
                }
            }
        });

    });


     $('#password1_incorrect-text').hide();
    $('#password1_correct').hide();
    $('#password1_incorrect').hide();
    $("#password1").change(function(){
        var password1 = $(this).val();

        $.ajax({
            url: '{% url "validate_password" %}',
            data:{
                'password':password1
                },
                dataType:'json',
                success: function (data) {
                if (data.correct) {

                $('#password1_correct').show();
                $('#password1_incorrect').hide();
                $('#password1_incorrect-text').hide();

                }else{

                $('#password1_incorrect-text').html(data.message).show();
                $('#password1_incorrect').show();
                $('#password1_correct').hide();
                }
            }
        });

    });


    $('#match').hide();
    $('#mismatch').hide();
    $("#password2").keyup(function(){
        var password1 = $('#password1').val();
        var password2 = $(this).val();
        if (password1===password2){
            $('#match').show();
            $('#mismatch').hide();
        }else{
            $('#match').hide();
            $('#mismatch').show();
        }
    });

</script>
{% endblock %}